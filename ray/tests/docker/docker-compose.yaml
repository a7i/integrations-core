version: '3.8'

services:
  ray-head:
    container_name: ray-head
    hostname: ray-head
    image: rayproject/ray-ml:2.6.1-cpu
    command: bash -c "ray start --port=6379 --dashboard-host=0.0.0.0 --head --block"
    ports:
      - "6379:6379"
      - "8265:8265"
      - "10001:10001"
  ray-worker-1:
    container_name: ray-worker-1
    hostname: ray-worker-1
    image: rayproject/ray-ml:2.6.1-cpu
    command: bash -c "ray start --address=ray-head:6379 --num-cpus=2 --block"
    depends_on:
      ray-head:
        condition: service_started
  ray-worker-2:
    container_name: ray-worker-2
    hostname: ray-worker-2
    image: rayproject/ray-ml:2.6.1-cpu
    command: bash -c "ray start --address=ray-head:6379 --num-cpus=2 --block"
    depends_on:
      ray-head:
        condition: service_started
  ray-worker-3:
    container_name: ray-worker-3
    hostname: ray-worker-3
    image: rayproject/ray-ml:2.6.1-cpu
    command: bash -c "ray start --address=ray-head:6379 --num-cpus=2 --block"
    depends_on:
      ray-head:
        condition: service_started